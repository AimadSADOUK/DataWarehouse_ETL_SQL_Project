-- Loocking for duplicated primary key
--Expectation: 
select cst_id,
count(*)
from silver.crm_cust_info
group by cst_id
Having count(*) > 1 OR cst_id IS NULL;

-- Checking unwanted spaces
SELECT cst_firstname
FROM silver.crm_cust_info
WHERE cst_firstname != TRIM(cst_firstname);

SELECT cst_lastname
FROM silver.crm_cust_info
WHERE cst_lastname != TRIM(cst_lastname);

-- Data standardizzation & consistency
select distinct cst_gndr
FROM silver.crm_cust_info;

select distinct
cst_marital_status
FROM silver.crm_cust_info
------------------------------------------------------------------------
Testing for silver.crm_sales_details TABLE
-----------------------------------------------------------------------


-- Check Invalid Dates
SELECT 
NULLIF(sls_order_dt, 0) AS sls_order_dt
FROM bronze.crm_sales_details
WHERE sls_order_dt <= 0
OR LEN(sls_order_dt) != 8;

-- CAHCK for NULL & Nagative values
SELECT 
sls_sales,
sls_quantity,
sls_price
FROM silver.crm_sales_details
WHERE sls_sales IS NULL OR sls_sales < 0 OR sls_sales != sls_quantity * sls_price
OR sls_quantity IS NULL OR sls_quantity < 0 
OR sls_price IS NULL OR sls_price < 0 
ORDER BY sls_sales, sls_quantity, sls_price
;
---------------------------------------------------------------------------------
Testing for silver.erp_cust_az12 TABLE
---------------------------------------------------------------------------------
-- Identify out-of range dates
SELECT 
bdate
FROM silver.erp_cust_az12
WHERE bdate > '2026-01-01'
OR bdate < '1924-01-01';

-- Data standardization / consistency
SELECT Distinct gen
FROM silver.erp_cust_az12;
-------------------------------------------------------------------------------------
Testing for silver.erp_loc_a101 TABLE
-------------------------------------------------------------------------------------
-- Data standardization / consistancy
SELECT DISTINCT cntry
FROM silver.erp_loc_a101;
